(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{2858:function(e,t,a){Promise.resolve().then(a.bind(a,4591))},4591:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return d}});var s=a(7437),r=a(2265),n=a(6881),i=a(6463),c=a(7138),l=a(6079),o=a(6251);function d(){let[e,t]=(0,r.useState)([]),[a,d]=(0,r.useState)(!0),[u,m]=(0,r.useState)("ALL"),f=(0,i.useRouter)(),h=(0,n.AY)();(0,r.useEffect)(()=>{x(),b()},[]);let x=async()=>{let{data:{session:e}}=await h.auth.getSession();e||f.push("/login")},b=async()=>{try{let{data:e,error:a}=await h.from("invoices").select("*, materials(*)").order("created_at",{ascending:!1});if(a)throw a;t(e||[])}catch(e){console.error("Error fetching invoices:",e)}finally{d(!1)}},p=e=>"paid"===e?"status-paid":"sent"===e?"status-sent":"status-draft",y=e=>"paid"===e?"PAID":"sent"===e?"SENT":"DRAFT",N=e.filter(e=>"PAID"===u?"paid"===e.status:"UNPAID"!==u||"paid"!==e.status),j=e=>{let t=new Date(e),a=t.getDate().toString().padStart(2,"0"),s=(t.getMonth()+1).toString().padStart(2,"0");return"".concat(a,"/").concat(s)},v=e=>{let t=e.split("-").pop()||e;return"#".concat(t.slice(-4).toUpperCase())};return a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)("span",{className:"font-mono text-sm",children:"/ / LOADING RECORDS"})}),(0,s.jsx)(l.Z,{})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"sticky top-0 z-10 bg-yapmate-black border-b border-yapmate-slate-700 dark:border-yapmate-slate-700",children:(0,s.jsx)("div",{className:"flex h-12",children:["ALL","UNPAID","PAID"].map(e=>(0,s.jsx)("button",{onClick:()=>m(e),className:"flex-1 font-mono text-xs font-semibold tracking-wide transition-colors duration-snap ".concat(u===e?"bg-yapmate-amber text-yapmate-black border-r-2 border-yapmate-black":"bg-yapmate-black text-yapmate-white border-r border-yapmate-slate-700 active:bg-yapmate-slate-900"),children:e},e))})}),(0,s.jsxs)("main",{className:"min-h-screen",children:[0===N.length?(0,s.jsx)("div",{className:"flex items-center justify-center py-24",children:(0,s.jsx)("span",{className:"font-mono text-sm text-yapmate-slate-300",children:"/ / NO RECORDS FOUND"})}):(0,s.jsx)("div",{className:"data-grid",children:N.map(e=>{var t;let a=(0,o.IG)(e.labour_hours,e.labour_rate,(null===(t=e.materials)||void 0===t?void 0:t.map(e=>({cost:e.cost,quantity:e.quantity})))||[],e.cis_job,e.cis_rate,e.vat_registered,e.vat_rate);return(0,s.jsx)(c.default,{href:"/invoice?id=".concat(e.id),className:"block",children:(0,s.jsxs)("div",{className:"h-20 flex items-center px-4 border-b border-yapmate-slate-700 dark:border-yapmate-slate-700 transition-colors duration-0 active:bg-yapmate-amber active:text-yapmate-black",children:[(0,s.jsxs)("div",{className:"w-16 flex-shrink-0",children:[(0,s.jsx)("div",{className:"data-label text-[0.625rem]",children:j(e.created_at)}),(0,s.jsx)("div",{className:"font-mono text-xs mt-0.5",children:v(e.id)})]}),(0,s.jsxs)("div",{className:"flex-1 min-w-0 px-4",children:[(0,s.jsx)("div",{className:"font-sans font-bold text-base truncate",children:e.customer_name||"UNNAMED"}),(0,s.jsx)("div",{className:p(e.status),children:y(e.status)})]}),(0,s.jsx)("div",{className:"w-28 flex-shrink-0 text-right",children:(0,s.jsx)("div",{className:"font-mono text-xl font-bold tabular-nums",children:(0,o.xG)(a.grandTotal)})})]})},e.id)})}),(0,s.jsx)("div",{className:"h-20"})]}),(0,s.jsx)("div",{className:"fixed bottom-0 left-0 right-0 pb-safe",children:(0,s.jsx)(c.default,{href:"/record",className:"bar-button h-14",children:"CREATE NEW RECORD"})}),(0,s.jsx)(l.Z,{})]})}},6079:function(e,t,a){"use strict";a.d(t,{Z:function(){return i}});var s=a(7437),r=a(7138),n=a(6463);function i(){let e=(0,n.usePathname)();return(0,s.jsx)("nav",{className:"fixed bottom-0 left-0 right-0 bg-yapmate-black/95 backdrop-blur-lg border-t border-yapmate-slate-800 pb-safe",children:(0,s.jsx)("div",{className:"flex justify-around items-center",style:{height:"68px"},children:[{href:"/dashboard",label:"Home",icon:"\uD83C\uDFE0"},{href:"/record",label:"Record",icon:"\uD83C\uDFA4"},{href:"/customers",label:"Customers",icon:"\uD83D\uDC65"},{href:"/settings",label:"Settings",icon:"⚙️"}].map(t=>{let a=e===t.href;return(0,s.jsxs)(r.default,{href:t.href,className:"flex flex-col items-center justify-center flex-1 h-full transition-colors duration-200 tap-highlight ".concat(a?"text-yapmate-amber-500":"text-yapmate-slate-400 active:text-yapmate-slate-200"),children:[(0,s.jsx)("span",{className:"text-2xl mb-1",children:t.icon}),(0,s.jsx)("span",{className:"text-xs font-semibold",children:t.label})]},t.href)})})})}},6881:function(e,t,a){"use strict";a.d(t,{AY:function(){return l},OQ:function(){return i}});var s=a(2562);a(4392);let r="https://nidijdprgoauwkmuioer.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5pZGlqZHByZ29hdXdrbXVpb2VyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUyMDc4NzcsImV4cCI6MjA4MDc4Mzg3N30.kpCiLgYxayUlUOPM0Uip1QsT5wnBpj7gv8yLKOB0vDY";if(!r||!n)throw Error("Missing Supabase environment variables");let i=(0,s.eI)(r,n),c=null;function l(){return c||(c=(0,s.eI)(r,n))}},6251:function(e,t,a){"use strict";function s(e,t,a,s,r,n,i){let c=!e||e<=0?0:e*t,l=a.reduce((e,t)=>e+t.cost*t.quantity,0),o=c+l,d=s?c<=0?0:c*r/100:0,u=o-d,m=n?u<=0?0:u*i/100:0;return{labourSubtotal:c,materialsSubtotal:l,subtotal:o,cisDeduction:d,vatAmount:m,grandTotal:u+m}}function r(e){return new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP"}).format(e)}a.d(t,{IG:function(){return s},xG:function(){return r}})}},function(e){e.O(0,[231,730,971,23,744],function(){return e(e.s=2858)}),_N_E=e.O()}]);
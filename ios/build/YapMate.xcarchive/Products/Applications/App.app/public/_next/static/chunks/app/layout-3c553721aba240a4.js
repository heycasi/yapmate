(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{202:function(e,r,n){Promise.resolve().then(n.bind(n,1829)),Promise.resolve().then(n.t.bind(n,36,23)),Promise.resolve().then(n.t.bind(n,7819,23)),Promise.resolve().then(n.t.bind(n,8877,23))},1829:function(e,r,n){"use strict";n.d(r,{IAPProvider:function(){return i}});var o=n(7437),t=n(2265),a=n(4392),s=n(9839),c=n(357);function i(e){let{children:r}=e;return(0,t.useEffect)(()=>{(0,s.Pj)()&&(async()=>{try{var e;let r=(0,a.createClientComponentClient)(),{data:{session:n}}=await r.auth.getSession(),o=c.env.NEXT_PUBLIC_REVENUECAT_IOS_API_KEY;if(!o){console.error("[IAP] NEXT_PUBLIC_REVENUECAT_IOS_API_KEY not set");return}await (0,s.nG)(o,null==n?void 0:null===(e=n.user)||void 0===e?void 0:e.id),console.log("[IAP] Initialized successfully")}catch(e){console.error("[IAP] Initialization failed:",e)}})()},[]),(0,o.jsx)(o.Fragment,{children:r})}},9839:function(e,r,n){"use strict";n.d(r,{Hu:function(){return l},NS:function(){return u},O3:function(){return f},Pj:function(){return s},TQ:function(){return t},nG:function(){return c},si:function(){return i}});var o=n(7185);let t={PRO_MONTHLY:"com.yapmate.pro.monthly",TRADE_MONTHLY:"com.yapmate.trade.monthly"},a=!1;function s(){return"ios"===o.dV.getPlatform()}async function c(e,r){if(!s()){console.log("[IAP] Not available on web, skipping configuration");return}if(a){console.log("[IAP] Already configured, skipping");return}try{let{Purchases:o}=await n.e(586).then(n.bind(n,1938));await o.configure({apiKey:e,appUserID:r||void 0}),a=!0,console.log("[IAP] RevenueCat configured successfully",{appUserID:r})}catch(e){throw console.error("[IAP] Configuration failed:",e),Error("IAP configuration failed: ".concat(e.message))}}async function i(){if(!s())return console.warn("[IAP] getOfferings called on web - returning empty array"),[];if(!a)return console.error("[IAP] SDK not configured - call configureIAP first"),[];try{let{Purchases:e}=await n.e(586).then(n.bind(n,1938)),r=await e.getOfferings();if(!r.current)return console.warn("[IAP] No current offering found"),[];let o=[r.current,...Object.values(r.all)];return console.log("[IAP] Loaded offerings:",o.length),o}catch(e){return console.error("[IAP] Failed to get offerings:",e),[]}}async function l(e){if(!s())return{success:!1,error:"In-app purchases are only available on iOS. Please use the mobile app."};if(!a)return{success:!1,error:"IAP not configured"};try{let{Purchases:o}=await n.e(586).then(n.bind(n,1938));console.log("[IAP] Starting purchase by product ID:",e);let t=await o.getOfferings(),a=[t.current,...Object.values(t.all||{})].filter(Boolean),s=null;for(let n of a){if(null==n?void 0:n.availablePackages)for(let o of n.availablePackages){var r;if((null===(r=o.product)||void 0===r?void 0:r.identifier)===e){s=o.product;break}}if(s)break}if(!s)return{success:!1,error:"Product not found in available offerings"};let c=await o.purchaseStoreProduct({product:s});return console.log("[IAP] Purchase successful"),{success:!0,customerInfo:c.customerInfo}}catch(e){if(console.error("[IAP] Purchase failed:",e),"USER_CANCELLED"===e.code||e.userCancelled)return{success:!1,error:"Purchase cancelled",userCancelled:!0};return{success:!1,error:e.message||"Purchase failed"}}}async function u(){if(!s())return{success:!1,error:"In-app purchases are only available on iOS. Please use the mobile app."};if(!a)return{success:!1,error:"IAP not configured"};try{let{Purchases:e}=await n.e(586).then(n.bind(n,1938));console.log("[IAP] Restoring purchases...");let r=await e.restorePurchases();return console.log("[IAP] Restore successful"),{success:!0,customerInfo:r.customerInfo}}catch(e){return console.error("[IAP] Restore failed:",e),{success:!1,error:e.message||"Failed to restore purchases"}}}async function f(){if(!s())return console.warn("[IAP] getCustomerInfo called on web"),null;if(!a)return console.error("[IAP] SDK not configured"),null;try{let{Purchases:e}=await n.e(586).then(n.bind(n,1938));return(await e.getCustomerInfo()).customerInfo}catch(e){return console.error("[IAP] Failed to get customer info:",e),null}}},8877:function(){},7819:function(e){e.exports={style:{fontFamily:"'__Inter_37ef13', '__Inter_Fallback_37ef13'",fontStyle:"normal"},className:"__className_37ef13",variable:"__variable_37ef13"}},36:function(e){e.exports={style:{fontFamily:"'__Space_Grotesk_4f4604', '__Space_Grotesk_Fallback_4f4604'",fontStyle:"normal"},className:"__className_4f4604",variable:"__variable_4f4604"}}},function(e){e.O(0,[540,392,790,971,23,744],function(){return e(e.s=202)}),_N_E=e.O()}]);